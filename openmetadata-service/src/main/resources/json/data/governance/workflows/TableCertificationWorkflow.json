{
  "name": "TableEntityCertificationWorkflow",
  "description": "TableEntityCertificationWorkflow",
  "type": "periodicBatchEntityWorkflow",
  "trigger": {
    "type": "periodicBatchEntityTrigger",
    "config": {
      "schedule": {
        "scheduleTimeline": "Custom",
        "cronExpression": "0 5 */15 * *"
      },
      "entityType": "table"
    }
  },
  "nodes": [
    {
      "type": "startEvent",
      "subType": "startEvent",
      "name": "EntityArrived",
      "displayName": "Entity to be Certified Arrived"
    },
    {
      "type": "endEvent",
      "subType": "endEvent",
      "name": "NoCertificationEnd",
      "displayName": "Result: Not Certified"
    },
    {
      "type": "endEvent",
      "subType": "endEvent",
      "name": "BronzeCertificationEnd",
      "displayName": "Result: Bronze Certified"
    },
    {
      "type": "endEvent",
      "subType": "endEvent",
      "name": "SilverCertificationEnd",
      "displayName": "Result: Silver Certified"
    },
    {
      "type": "endEvent",
      "subType": "endEvent",
      "name": "GoldCertificationEnd",
      "displayName": "Result: Gold Certified"
    },
    {
      "type": "automatedTask",
      "subType": "checkEntityAttributesTask",
      "name": "OwnersAndDescriptionAreNotNullOrEmpty",
      "displayName": "Owners and Description are not Null nor Empty",
      "config": {
        "rules": "{ \"and\": [ { \"!!\": [ { \"var\": \"owners\" } ] }, { \"!!\": [ { \"var\": \"description\" } ] } ] }"
      }
    },
    {
      "type": "automatedTask",
      "subType": "checkEntityAttributesTask",
      "name": "IsTier1OrTier2",
      "displayName": "Entity is Tier 1 or Tier 2",
      "config": {
        "rules": "{ \"or\": [ {\"some\":[{\"var\":\"tags\"},{\"==\":[{\"var\":\"name\"},\"Tier2\"]}]}, {\"some\":[{\"var\":\"tags\"},{\"==\":[{\"var\":\"name\"},\"Tier1\"]}]} ] }"
      }
    },
    {
      "type": "automatedTask",
      "subType": "checkEntityAttributesTask",
      "name": "IsTier1",
      "displayName": "Entity Is Tier 1",
      "config": {
        "rules": "{\"some\":[{\"var\":\"tags\"},{\"==\":[{\"var\":\"name\"},\"Tier1\"]}]}"
      }
    },
    {
      "type": "automatedTask",
      "subType": "setEntityCertificationTask",
      "name": "SetNoCertification",
      "displayName": "Don't set certification",
      "config": {
        "certification": null
      }
    },
    {
      "type": "automatedTask",
      "subType": "setEntityCertificationTask",
      "name": "SetBronzeCertification",
      "displayName": "Set Bronze Certification",
      "config": {
        "certification": "Certification.Bronze"
      }
    },
    {
      "type": "automatedTask",
      "subType": "setEntityCertificationTask",
      "name": "SetSilverCertification",
      "displayName": "Set Silver Certification",
      "config": {
        "certification": "Certification.Silver"
      }
    },
    {
      "type": "automatedTask",
      "subType": "setEntityCertificationTask",
      "name": "SetGoldCertification",
      "displayName": "Set Gold Certification",
      "config": {
        "certification": "Certification.Gold"
      }
    }
  ],
  "edges": [
    {
      "from": "EntityArrived",
      "to": "OwnersAndDescriptionAreNotNullOrEmpty"
    },
    {
      "from": "OwnersAndDescriptionAreNotNullOrEmpty",
      "to": "SetNoCertification",
      "condition": false
    },
    {
      "from": "OwnersAndDescriptionAreNotNullOrEmpty",
      "to": "IsTier1OrTier2",
      "condition": true
    },
    {
      "from": "SetNoCertification",
      "to": "NoCertificationEnd"
    },
    {
      "from": "IsTier1OrTier2",
      "to": "SetBronzeCertification",
      "condition": false
    },
    {
      "from": "IsTier1OrTier2",
      "to": "IsTier1",
      "condition": true
    },
    {
      "from": "SetBronzeCertification",
      "to": "BronzeCertificationEnd"
    },
    {
      "from": "IsTier1",
      "to": "SetSilverCertification",
      "condition": false
    },
    {
      "from": "IsTier1",
      "to": "SetGoldCertification",
      "condition": true
    },
    {
      "from": "SetSilverCertification",
      "to": "SilverCertificationEnd"
    },
    {
      "from": "SetGoldCertification",
      "to": "GoldCertificationEnd"
    }
  ]
}